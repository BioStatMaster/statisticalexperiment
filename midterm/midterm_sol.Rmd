---
title: '[70점] 중간고사 모범 답안'
output:
  html_document:
    df_print: paged
  pdf_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
set.seed(1) # 고정
```

---

## [15점] 문제 1

표준 정규분포의 확률밀도함수의 그래프를 그리고자 한다.

#### 1.1 (5점)

-4부터 4까지 0.01의 간격을 가지는 벡터를 변수 `x`에 저장하시오.

```{r}
x <- seq(-4, 4, 0.01)
```

#### 1.2 (5점)

1.1에서 저장한 변수 `x`에 대해 표준정규분포의 확률밀도함수값을 구해 변수 `fx1`에 저장하시오. 이 때, dnorm() 또는 pnorm()과 같은 정규분포에 관련된 내장함수를 사용할 수 없고 아래의 확률밀도함수 식을 이용 해야한다. 
$$
f(x) = \frac{1}{\sqrt{2\pi}}e^{-\frac{x^2}{2}}
$$

여기서 지수함수 $e$는 R에서 `exp()` 함수와 대응되며, $\pi$ 는 `pi`와 대응된다. 

```{r}
fx1 <- 1/sqrt(2*pi)*exp(-x^2/2)
```

#### 1.3 (5점)

1.1, 1.2에서 저장한 변수들을 이용하여 표준정규분포의 확률밀도함수 그래프를 $-4\leq x\leq 4$의 범위에 대해 그리시오.

```{r}
plot(x, fx1, type='l')
```

---

## [20점] 문제 2 

연속확률변수 $X$에 대해 $X$의 누적분포함수(cumulative distribution function) $F(x) = P(X\leq x)$가 $x$ 에 대한 strictly increasing function이라고 하자. $U$는 균등분포 $U[0,1]$을 따르는 연속확률변수라 하자. 이때, $X$와 $F^{-1}(U)$는 같은 분포를 가진다는 것이 알려져 있다.

우리는 위의 사실을 표준정규분포를 따르는 $X$에 대해서 확인해보고자 한다.

#### 2.1 (5점)

균등분포 $U\sim[0,1]$에서 랜덤 표본 20000개를 생성해 변수 `u`에 저장하시오.

```{r}
u <- runif(20000, min=0, max=1)
```

#### 2.2 (5점)

2.1에서 저장한 `u`에 대해 표준정규분포의 분위수값을 구해 변수 `fx2`에 저장하시오

```{r}
fx2 <- qnorm(u)
```


#### 2.3 (5점)

2.2에서 저장한 변수 `fx2`에 대해 히스토그램을 그리시오. 이 때 구간의 수는 30으로 하고, 히스토그램의 Y축을 각 구간의 확률밀도로 나타낸다.

```{r}
hist(fx2, breaks = seq(min(fx2), max(fx2),
length.out = 31), freq = F)
```

#### 2.4 (5점)

문제 1부터 문제2.3까지의 코드를 적절히 작성했다면, 2.3 코드 실행 후 아래의 코드를 실행 시 $X$와 $F^{-1}(U)$는 같은 분포를 가진다는 것을 눈으로 확인 가능하다.

```{r}
# lines(x,fx1, col='red') 실행 시 #은 삭제
```

지금보다 히스토그램을 더 빨간선에 가깝게 만들기 위해서는 어떻게 문제 2의 코드를 수정할 수 있을지 한 가지 방안을 주석으로 서술하시오.

```{r}
# 2.1에서 더 많은 랜덤 표본을 생성하고, 2.3에서 구간의 수를 지금보다 늘린다. 
```

---

## [15점] 문제 3

bodydims.csv 데이터를 가지고 성별에 따른 차이를 살펴보고자 한다. 

#### 3.1 (5점)

bodydims.csv 파일을 불러와 변수 `bodydims`에 저장하시오.

```{r}
bodydims <- read.csv("/Users/dwkim/Documents/대학원/2025-S/통계학실험/강의자료/dataset/ch04/bodydims.csv", header=TRUE)
```

#### 3.2 (5점)

bodydims.csv자료에서 sex변수는 성별을 의미하고, 남성은 1 여성은 0의 값을 가진다. 이 때, 남성의 자료를 변수 `bodydims.m`에 여성의 자료를 변수 `bodydims.f`에 저장하시오.

```{r}
bodydims.m = bodydims[bodydims$sex == 1,]
bodydims.f = bodydims[bodydims$sex == 0,]
```

#### 3.3 (5점)

bodydims.csv자료에서 hgt변수는 신장(cm)를 의미한다. 주어진 데이터를 모집단으로 가정할 때, 남성 신장의 평균과 분산을 각각 변수 `m1`, `s1`에, 여성 신장의 평균과 분산을 각각 변수 `m2`, `s2`에 저장하시오. 여기서 분산은 모분산을 의미한다.

```{r}
n1 <- length(bodydims.m$hgt)
m1 <- mean(bodydims.m$hgt)
s1 <- var(bodydims.m$hgt) * (n1-1) / n1

n2 <- length(bodydims.f$hgt)
m2 <- mean(bodydims.f$hgt)
s2 <- var(bodydims.f$hgt) * (n2-1) / n2
```

---

## [20점] 문제 4

전체 통계학 실험 수강생들의 중간고사 기간 (4/15 ~ 4/21) 커피 소비량 평균을 구해보려고 한다. 통계학 실험 수강생들 중 009 분반 수강생 36명을 대상으로 조사해본 결과 중간고사 기간 커피 소비량의 표본평균은 10잔이라는 결과를 얻었다. 전체 통계학 실험 수강생들의 일주일 커피 소비량의 분산은 4.5잔으로 알려져 있다.

유의수준 5% 하에서, 전체 통계학 실험 수강생들의 일주일 커피 소비량의 실제 평균은 11잔이 아니라고 할 수 있는지 알아보자. 

#### 4.1 (5점)

귀무가설과 대립가설을 각각 주석으로 서술하시오.

```{r}
# 귀무가설: 평균 커피 소비량은 11잔이다.
# 대립가설: 평균 커피 소비량은 11잔이 아니다.
```

#### 4.2 (5점)

검정통계량의 값을 계산하여 변수 `Z`에 저장하시오.

```{r}
x.bar <- 10
mu0 <- 11
n <- 36
sigma <- sqrt(4.5)

Z <- (x.bar - mu0) / (sigma/sqrt(n))
```

#### 4.3 (5점)

앞서 계산한 검정통계량을 바탕으로 검정을 실시할 것이다. 변수 `is_reject`에 귀무가설을 기각한다면 TRUE를, 귀무가설을 기각할 수 없다면 FALSE를 저장하게끔 조건문을 작성하시오. (직접 TRUE 혹은 FALSE를 저장하는 경우 점수를 부여하지 않습니다.)

```{r}
alpha = 0.05
is_reject <- abs(Z) >= qnorm(1-alpha/2)
```

#### 4.4 (5점) 

변수 `is_reject`에 저장된 값을 바탕으로 검정에 대한 결론을 주석으로 서술하시오.

```{r}
# 검정 결과, 유의수준 5% 하에서 실제 평균 커피 소비량은 11잔이 아니다. 
```