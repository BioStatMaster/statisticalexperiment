---
title: "[70점] 과제 2"
output:
  html_document:
    df_print: paged
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

`hw2_skeleton.R` 파일의 `TODO`부분을 수정하여, 아래 주어진 문제를 해결하세요. `TODO`가 아닌 부분에 코드를 작성하셔도 무방합니다.

답만 작성하는 것이 아닌 풀이 과정을 담은 코드를 꼭 포함하셔야 합니다.

계산한 결과를 변수에 저장하는 문제의 경우, 지시한 이름의 변수에 정확히 저장하지 않으면, 0점이 부여됩니다.

예를 들어 `x`에 1을 저장하라는 문제가 있을 때, 아래와 같이 코드를 작성한 경우에는 0점이 부여됩니다.

```{r}
y <- 1
```

문제에서 요구하는 변수의 이름은 `hw2_skeleton.R`에도 작성되어 있으니, 대소문자가 헷갈리는 경우에 해당 파일을 참고하시기 바랍니다. 

제출은 `hw2_이름.R`로 해주시면 됩니다. (ex.`hw2_김동원.R`)

```{r}
set.seed(1) # 고정
```

---

## [15점] 문제 1

#### [10점] 1.1

dnorm() 또는 pnorm()과 같은 정규분포에 관련된 내장함수를 사용하지 않고 $-3 \leq x \leq 3$ 범위에서 표준 정규분포의 확률밀도함수의 그래프를 그려라. (아래의 확률밀도함수 식을 이용 한다.)

$$
f(x) = \frac{1}{\sqrt{2\pi}}e^{-\frac{x^2}{2}}
$$

여기서 지수함수 $e$는 R에서 `exp()` 함수와 대응되며, $\pi$ 는 `pi`와 대응된다. 

```{r}
x <- seq(-3, 3, 0.01)
fx1 <- 1/sqrt(2*pi)*exp(-x^2/2)
plot(x, fx1, type='l')
```


#### [5점] 1.2

1부터 6까지의 자연수가 하나씩 적혀 있는 주사위를 던진다고 하자. 이 때, 주사위의 각 면이 나올 확률은 모두 동일하다. 주사위를 총 200번 던졌을 때, 6의 약수가 150번 이상 170번 이하로 나올 확률을 구하여 변수 `p1`에 저장하시오.

```{r}
n = 200
p = 4/6
p1 <- pbinom(170, n, p) - pbinom(149, n, p)
```

---

## [25점] 문제 2

#### [5점] 2.1

5주차 모듈에 업로드되어 있는 ames.csv파일을 불러와 변수 `ames`에 저장하시오.

```{r}
ames <- read.csv("/Users/dwkim/Documents/대학원/2025-S/통계학실험/강의자료/dataset/ch04/ames.csv") #개인마다 다름
```

#### [5점] 2.2 

`ames`에 저장된 데이터프레임에서 집의 크기를 나타내는 변수인 Gr.Liv.Area를 불러와 변수 `area`에 저장하시오.

```{r}
area <- ames$Gr.Liv.Area
```

#### [10점] 2.3

변수 `area`에 저장된 값들이 모집단이라고 가정하자. 이 때, 크기 50의 랜덤 표본을 이용하여 모평균의 90% 신뢰구간을 구하고, 이렇게 계산한 신뢰구간의 하한값을 변수 `lower`에, 상한값을 변수 `upper`에 저장하시오.

```{r}
m <- 50
samples <- sample(area, m)
s.mean <- mean(samples)

n <- length(area)
sigma <- sd(area)*sqrt((n-1)/n) 
alpha <- 0.1

lower <- s.mean - qnorm(1-alpha/2)*sigma/sqrt(m)
upper <- s.mean + qnorm(1-alpha/2)*sigma/sqrt(m)
```


#### [5점] 2.4

위에서 구한 신뢰구간 내에 모평균이 포함되어 있는지 여부(TRUE or FALSE)를 조건문을 이용하여 변수 `is_contained`에 저장하시오. 만약 변수에 직접 TRUE 혹은 FALSE를 저장한다면, 점수를 부여하지 않습니다.

```{r}
mu <- mean(area)
is_contained <- (mu > lower) & (mu < upper)
```

---

## [15점] 문제 3 

#### [5점] 3.1

2.2에서 저장했던 `area`를 모집단이라고 가정하자. 이 때, 모집단의 표준편차를 함수 `var` 혹은 `sd`를 이용하지 않고 계산하여 변수 `result1`에 저장하시오.
```{r}
result1 <- sqrt(sum((area-mean(area))^2)/n)
```


#### [5점] 3.2

2.2에서 저장했던 `area`를 표본이라고 가정하자. 이 때, 표본 표준편차를 함수 `var` 혹은 `sd`를 이용하지 않고 계산하여 변수 `result2`에 저장하시오.
```{r}
result2 <- sqrt(sum((area-mean(area))^2)/(n-1))
```


#### [5점] 3.3

`resul1`의 `result2`에 대한 비에 대응하는 비율을 변수 `ratio`에 저장하시오.
```{r}
ratio <- result1 / result2
```

---

## [15점] 문제 4

서울대학교 통계학과 대학원생들의 인스타그램 팔로잉 수 평균을 구해보려고 한다. 그 중 통계학 실험 조교 11명을 대상으로 평균을 구해보았더니 276명이 나왔다. 서울대학교 통계학과 대학원생들의 인스타그램 팔로잉 수 표준편차는 52명으로 알려져 있다. 

통계학 실험 조교가 서울대학교 통계학과 대학원생들을 대표한다면, 유의수준 5% 하에서, 실제 평균 팔로잉 수가 247명이 아니라고 할 수 있는지 알아보자.

#### [5점] 4.1

귀무가설과 대립가설을 각각 주석으로 서술하시오.

```{r}
# 귀무 가설 : 서울대학교 통계학과 대학원생들의 평균 인스타그램 팔로잉은 247명이다.
# 대립 가설 : 서울대학교 통계학과 대학원생들의 평균 인스타그램 팔로잉은 247명이 아니다.
```


#### [5점] 4.2

검정통계량의 값을 계산하여 변수 `Z`에 저장하시오.

```{r}
n <- 11
x_bar <- 276
mu0 <- 247
sigma <- 52

Z <- (x_bar-mu0)/(sigma/sqrt(n))
```


#### [5점] 4.3

앞서 계산한 검정통계량을 바탕으로 유의수준 5% 하에서 검정을 실시하고, 결론을 주석으로 서술하시오. (Hint : qnorm()을 활용하자.)

```{r}
abs(Z) > qnorm(1-0.05/2)
# -1.96 < Z < 1.96이므로 유의수준 5%하에서 귀무가설을 기각할 수 없다. 즉 실제 평균 팔로잉 수는 247명이 아니라고 할 수 없다.
```


